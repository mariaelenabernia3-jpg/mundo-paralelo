<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>El Glitch Existencial</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">
</head>
<body class="theme-8bit">

    <!-- NUEVO: OVERLAY DE BLOQUEO PARA MÓVILES -->
    <div id="enforce-view-overlay">
        <div class="enforce-view-content">
            <h2>Acción Requerida</h2>
            <p>1. Activa el "Modo de escritorio" en tu navegador.</p>
            <p>2. Pon tu teléfono en posición horizontal.</p>
            <p>(El juego continuará automáticamente)</p>
        </div>
    </div>

    <!-- PANTALLA DE ROTACIÓN PARA MÓVILES (AHORA SECUNDARIA) -->
    <div id="rotate-screen">
        <img src="rotate.png" alt="Rotate Device">
        <p>Por favor, pon tu teléfono en horizontal o usa una computadora.</p>
    </div>

    <!-- PANTALLAS DE INTRODUCCIÓN -->
    <div id="language-selector" class="intro-screen">
        <h2 data-text-key="langTitle">Select Language</h2>
        <div>
            <button data-lang="es">Español</button>
            <button data-lang="en">English</button>
        </div>
    </div>
    <div id="lore-screen" class="intro-screen hidden">
        <p id="lore-text"></p>
        <p id="continue-prompt"></p>
    </div>
    <div id="preloader" class="intro-screen hidden">
        <div id="boot-sequence">
            <span id="boot-text"></span><span class="cursor"></span>
        </div>
    </div>
    
    <!-- MENÚ PRINCIPAL -->
    <div id="main-menu">
        <h1 class="glitch-title">El Glitch Existencial</h1>
        <div class="menu-options glitch-container">
            <nav>
                <button id="new-game-btn" data-text-key="newGame">Nueva Partida</button>
                <button id="load-game-btn" data-text-key="loadGame">Cargar Partida</button>
                <button id="options-btn" data-text-key="options">Opciones</button>
                <button id="credits-btn" data-text-key="credits">Créditos</button>
            </nav>
        </div>
    </div>
    
    <!-- DIÁLOGOS Y OVERLAYS -->
    <div id="first-time-dialogue" class="hidden">
        <p id="first-time-text"></p>
    </div>
    
    <div id="options-overlay" class="overlay hidden">
        <div class="glitch-container">
            <div class="overlay-content">
                <p class="dialogue-bubble" id="options-dialogue"></p>
                <h2 data-text-key="optionsTitle">Opciones</h2>
                <div class="options-group">
                    <label data-text-key="language">Idioma</label>
                    <div class="language-buttons">
                        <button id="lang-btn-es" data-lang="es">Español</button>
                        <button id="lang-btn-en" data-lang="en">English</button>
                    </div>
                </div>
                <div class="options-group">
                    <label for="master-volume" data-text-key="masterVolume">Volumen General</label>
                    <input type="range" id="master-volume" min="0" max="1" step="0.1">
                </div>
                <div class="options-group">
                    <label for="sfx-volume" data-text-key="sfxVolume">Efectos</label>
                    <input type="range" id="sfx-volume" min="0" max="1" step="0.1">
                </div>
                <button id="close-options-btn" data-text-key="close">Cerrar</button>
            </div>
        </div>
    </div>

    <div id="credits-overlay" class="overlay hidden">
        <div class="glitch-container">
            <div class="overlay-content">
                <p class="dialogue-bubble" id="credits-dialogue"></p>
                <h2 data-text-key="creditsTitle">Creador: DZM</h2>
                <button id="close-credits-btn" data-text-key="close">Cerrar</button>
            </div>
        </div>
    </div>

    <div id="save-slots-overlay" class="overlay hidden">
        <div class="glitch-container">
            <div class="overlay-content">
                <h2 id="save-slots-title"></h2>
                <div class="save-slot-container" id="slots-container"></div>
                <button id="close-slots-btn" data-text-key="close">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- PANTALLA DE CARGA -->
    <div id="loading-screen" class="overlay hidden">
        <div class="loader"></div>
        <p id="loading-dialogue"></p>
    </div>

    <canvas id="gameCanvas" class="hidden"></canvas>
    <div id="version-info">versión 0.1alpha</div>

    <!-- Elementos de audio -->
    <audio id="glitch-sound" src="glitch_01-226601.mp3" preload="auto"></audio>
    <audio id="background-music" src="meditation-music-sound-bite-339735.mp3" loop preload="auto"></audio>

    <script src="script.js"></script>

    <!-- SCRIPT DE VERIFICACIÓN DE VISTA -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const overlay = document.getElementById('enforce-view-overlay');
            const isMobile = /Mobi|Android|iPhone/i.test(navigator.userAgent);

            function checkMobileView() {
                if (!isMobile) return; // Si no es móvil, no hace nada

                // Condiciones: estar en horizontal Y tener un ancho de viewport grande (simulando "sitio de escritorio")
                const isLandscape = window.innerWidth > window.innerHeight;
                const isDesktopMode = window.innerWidth >= 980; // Un valor común para el modo escritorio en móviles

                if (isLandscape && isDesktopMode) {
                    overlay.classList.remove('visible');
                } else {
                    overlay.classList.add('visible');
                }
            }

            // Verificar al cargar y cada vez que la ventana cambie de tamaño
            checkMobileView();
            window.addEventListener('resize', checkMobileView);
        });
    </script>
</body>
</html>